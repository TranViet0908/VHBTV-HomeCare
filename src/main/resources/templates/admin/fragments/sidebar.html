<!-- code sau khi sửa -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .nice-scrollbar::-webkit-scrollbar { width: 8px; }
    .nice-scrollbar::-webkit-scrollbar-track { background: rgba(255,255,255,0.06); }
    .nice-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.25); border-radius: 9999px; }
    .nice-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.35); }
  </style>
</head>
<body>
<div th:fragment="sidebar"
     class="bg-gradient-to-b from-gray-900 to-gray-800 text-white w-64 h-screen shadow-2xl fixed left-0 top-0 z-40 overflow-y-auto overscroll-contain nice-scrollbar">
  <!-- Logo -->
  <div class="p-6 border-b border-gray-700/50">
    <a href="/admin/dashboard" class="flex items-center space-x-3 group">
      <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg">
        <img alt="Logo" class="w-6 h-6 object-contain" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
             src="/assets/img/HouseServiceLogo.png">
        <i class="fas fa-tools text-white text-sm hidden"></i>
      </div>
      <div>
        <div class="font-bold text-lg text-white group-hover:text-blue-300 transition-colors duration-200">
          HouseService
        </div>
        <div class="text-xs text-gray-400">Admin</div>
      </div>
    </a>
  </div>

  <!-- Menu -->
  <div class="py-4">
    <nav class="space-y-1 px-3">
      <!-- Dashboard -->
      <a href="/admin/dashboard" id="nav-dashboard" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group">
        <i class="fas fa-home w-5 text-center group-hover:text-blue-400 transition-colors duration-200"></i>
        <span class="font-medium">Dashboard</span>
      </a>

      <!-- 1. Quản lý người dùng & phân quyền -->
      <a href="/admin/users" id="nav-users"
         class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group">
        <i class="fas fa-user-cog w-5 text-center group-hover:text-red-400 transition-colors duration-200"></i>
        <span>Người dùng & Vai trò</span>
        <span class="ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full">Admin</span>
      </a>

      <!-- 2. Duyệt hồ sơ vendor (tách riêng) -->
      <a class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/vendor-applications"
         id="nav-vendor-apps">
        <i class="fas fa-stamp w-5 text-center group-hover:text-yellow-400 transition-colors duration-200"></i>
        <span>Duyệt hồ sơ vendor</span>
      </a>

      <!-- Vendor dropdown -->
      <details class="group" id="menu-vendor">
        <summary
                class="nav-item flex items-center justify-between px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 cursor-pointer">
          <span class="flex items-center space-x-3">
            <i class="fas fa-store w-5 text-center group-hover:text-blue-400 transition-colors duration-200"></i>
            <span class="font-medium">Vendor</span>
          </span>
          <i class="fas fa-chevron-down text-xs transition-transform duration-200 group-open:rotate-180"></i>
        </summary>

        <div class="ml-8 mt-1 space-y-1">
          <!-- 3. Hồ sơ vendor -->
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/vendors"
             id="nav-vendors">
            <i class="fas fa-briefcase w-5 text-center group-hover:text-emerald-400 transition-colors duration-200"></i>
            <span>Hồ sơ vendor</span>
          </a>
          <!-- Kỹ năng vendor -->
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/vendor-skills"
             id="nav-vendor-skills">
            <i class="fas fa-tools w-5 text-center group-hover:text-teal-400 transition-colors duration-200"></i>
            <span>Kỹ năng vendor</span>
          </a>
          <!-- 5. Gói dịch vụ của vendor -->
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/vendor-services"
             id="nav-vendor-services">
            <i class="fas fa-boxes w-5 text-center group-hover:text-purple-400 transition-colors duration-200"></i>
            <span>Gói dịch vụ vendor</span>
          </a>
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/vendor-service-media"
             id="nav-vendor-service-media">
            <i class="fa-solid fa-photo-film w-5 text-center group-hover:text-purple-400 transition-colors duration-200"></i>
            <span>Phương tiện truyền thông vendor</span>
          </a>
        </div>
      </details>

      <!-- 4. Danh mục dịch vụ chuẩn -->
      <a class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/services" id="nav-services">
        <i class="fas fa-list-alt w-5 text-center group-hover:text-indigo-400 transition-colors duration-200"></i>
        <span>Danh mục dịch vụ</span>
      </a>

      <!-- 8. Đơn dịch vụ -->
      <a class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/service-orders"
         id="nav-service-orders">
        <i class="fas fa-receipt w-5 text-center group-hover:text-blue-300 transition-colors duration-200"></i>
        <span>Đơn dịch vụ</span>
      </a>

      <!-- 9. Thanh toán & đối soát -->
      <a href="/admin/payments" id="nav-payments" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group">
        <i class="fas fa-wallet w-5 text-center group-hover:text-cyan-400 transition-colors duration-200"></i>
        <span>Thanh toán & Đối soát</span>
      </a>

      <!-- 10. Mã giảm giá -->
      <details class="group" id="menu-coupons">
        <summary
                class="nav-item flex items-center justify-between px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 cursor-pointer">
    <span class="flex items-center space-x-3">
      <i class="fas fa-tags w-5 text-center group-hover:text-emerald-300 transition-colors duration-200"></i>
      <span class="font-medium">Mã giảm giá</span>
    </span>
          <i class="fas fa-chevron-down text-xs transition-transform duration-200 group-open:rotate-180"></i>
        </summary>

        <div class="ml-8 mt-1 space-y-1">
          <!-- Danh sách mã -->
          <a href="/admin/coupons"
             class="nav-item flex items-center space-x-3 px-3 py-2 rounded-md text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200">
            <i class="fa-solid fa-list-ul w-5 text-center"></i>
            <span>Danh sách mã</span>
          </a>

          <!-- Gán người dùng -->
          <a href="/admin/coupons?pick=users"
             class="nav-item flex items-center space-x-3 px-3 py-2 rounded-md text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200">
            <i class="fa-solid fa-user-plus w-5 text-center"></i>
            <span>Gán người dùng</span>
          </a>

          <!-- Gán vendor -->
          <a href="/admin/coupons?pick=vendors"
             class="nav-item flex items-center space-x-3 px-3 py-2 rounded-md text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200">
            <i class="fa-solid fa-briefcase w-5 text-center"></i>
            <span>Gán vendor</span>
          </a>
        </div>
      </details>

      <!-- Đánh giá dropdown -->
      <details class="group" id="menu-reviews">
        <summary
                class="nav-item flex items-center justify-between px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 cursor-pointer">
          <span class="flex items-center space-x-3">
            <i class="fas fa-star w-5 text-center group-hover:text-amber-300 transition-colors duration-200"></i>
            <span class="font-medium">Đánh giá</span>
          </span>
          <i class="fas fa-chevron-down text-xs transition-transform duration-200 group-open:rotate-180"></i>
        </summary>
        <div class="ml-8 mt-1 space-y-1">
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/reviews/service"
             id="nav-reviews-service">
            <i class="fas fa-star-half-alt w-5 text-center group-hover:text-amber-300 transition-colors duration-200"></i>
            <span>Đánh giá dịch vụ của vendor</span>
          </a>
          <a class="nav-item flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/reviews/vendor"
             id="nav-reviews-vendor">
            <i class="fas fa-user-check w-5 text-center group-hover:text-amber-200 transition-colors duration-200"></i>
            <span>Đánh giá vendor</span>
          </a>
        </div>
      </details>

      <!-- 13. Báo cáo & dashboard -->
      <a class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/reports"
         id="nav-reports">
        <i class="fas fa-chart-line w-5 text-center group-hover:text-emerald-400 transition-colors duration-200"></i>
        <span>Báo cáo</span>
      </a>

      <!-- 14. Cấu hình hệ thống -->
      <a class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-700/50 hover:text-white transition-all duration-200 group" href="/admin/settings"
         id="nav-settings">
        <i class="fas fa-cogs w-5 text-center group-hover:text-gray-300 transition-colors duration-200"></i>
        <span>Cấu hình hệ thống</span>
      </a>
    </nav>
  </div>
</div>

<!-- Active menu highlight -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;

    document.querySelectorAll('.nav-item').forEach(item => {
      item.classList.remove('bg-blue-600/20', 'text-blue-300', 'border-l-4', 'border-blue-500', 'shadow-sm');
      item.classList.add('text-gray-300');
    });

    const routes = [
      { key: '/dashboard', id: 'nav-dashboard' },

      { key: '/users', id: 'nav-users' },
      { key: '/vendor-applications', id: 'nav-vendor-apps' },

      { key: '/vendors', id: 'nav-vendors' },
      { key: '/vendor-skills', id: 'nav-vendor-skills' },
      { key: '/vendor-services', id: 'nav-vendor-services' },
      { key: '/vendor-service-media', id: 'nav-vendor-service-media' },

      { key: '/services', id: 'nav-services' },

      { key: '/product-categories', id: 'nav-product-categories' },
      { key: '/products', id: 'nav-products' },

      { key: '/product-orders', id: 'nav-product-orders' },
      { key: '/service-orders', id: 'nav-service-orders' },

      { key: '/payments', id: 'nav-payments' },
      { key: '/coupons', id: 'nav-coupons' },

      // nhóm Đánh giá mới
      { key: '/reviews/service', id: 'nav-reviews-service' },
      { key: '/reviews/vendor',  id: 'nav-reviews-vendor' },

      { key: '/chatbot-logs', id: 'nav-chatbot-logs' },
      { key: '/reports', id: 'nav-reports' },
      { key: '/settings', id: 'nav-settings' },
    ];

    const found = routes.find(r => currentPath.includes(r.key));
    if (found) {
      const activeNav = document.getElementById(found.id);
      if (activeNav) {
        activeNav.classList.remove('text-gray-300');
        activeNav.classList.add('bg-blue-600/20', 'text-blue-300', 'border-l-4', 'border-blue-500', 'shadow-sm');

        // tự mở dropdown nếu link nằm trong <details>
        const details = activeNav.closest('details');
        if (details) details.setAttribute('open','');
      }
    }
  });
</script>
</body>
</html>
