<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head><meta charset="UTF-8"></head>
<body>
<!-- GRID DỊCH VỤ -->
<div th:fragment="serviceGrid (wishlistServices)">
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="wishlistGrid">
        <div class="wishlist-card bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden group"
             th:each="wishlist : ${wishlistServices}">
            <div class="relative h-48 overflow-hidden bg-gradient-to-br from-blue-100 to-purple-100">
                <a th:href="@{/vendor-services/{id}(id=${wishlist.vendorService.id})}">
                    <img class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
                         th:alt="${wishlist.vendorService.title}"
                         th:src="${wishlist.vendorService.coverUrl != null ? wishlist.vendorService.coverUrl : '/placeholder.svg?height=200&width=400'}">
                </a>

                <!-- Remove -->
                <button class="absolute top-3 right-3 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white transition-all hover:scale-110"
                        th:onclick="'WL.remove(this,' + ${wishlist.id} + ')'">
                    <i class="fas fa-heart text-red-500"></i>
                </button>

                <!-- Vendor badge -->
                <a th:href="@{/vendors/{key}(key=${wishlist.vendorService.vendor['displayName']})}"
                   class="absolute bottom-3 left-3">
                    <div class="flex items-center space-x-2 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full">
                        <div class="w-6 h-6 rounded-full overflow-hidden bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-bold">
                            <img th:if="${wishlist.vendorService.vendor['avatarUrl'] != null and !#strings.isEmpty(wishlist.vendorService.vendor['avatarUrl'])}"
                                 th:src="${wishlist.vendorService.vendor['avatarUrl']}" alt="" class="w-full h-full object-cover">
                            <span th:unless="${wishlist.vendorService.vendor['avatarUrl'] != null and !#strings.isEmpty(wishlist.vendorService.vendor['avatarUrl'])}"
                                  th:text="${#strings.substring(wishlist.vendorService.vendor['displayName'], 0, 1)}">V</span>
                        </div>
                        <span class="text-sm font-medium text-gray-700"
                              th:text="${wishlist.vendorService.vendor['displayName']}">Vendor Name</span>
                    </div>
                </a>
            </div>

            <div class="p-5">
                <a th:href="@{/vendor-services/{id}(id=${wishlist.vendorService.id})}">
                    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors"
                        th:text="${wishlist.vendorService.title}">Tên dịch vụ</h3>
                </a>

                <p class="text-sm text-gray-600 mb-4 line-clamp-2"
                   th:text="${wishlist.vendorService.description != null ? wishlist.vendorService.description : 'Mô tả đang cập nhật'}">Mô tả</p>

                <div class="flex items-center justify-between text-xs text-gray-500 mb-4 pb-4 border-b">
                    <div class="flex items-center space-x-1">
                        <i class="fas fa-star text-yellow-400"></i>
                        <span class="font-bold text-gray-900"
                              th:text="${#numbers.formatDecimal(wishlist.vendorService.ratingAvg != null ? wishlist.vendorService.ratingAvg : 0, 1, 'COMMA', 1, 'POINT')}">0.0</span>
                        <span th:text="${'(' + (wishlist.vendorService.ratingCount != null ? wishlist.vendorService.ratingCount : 0) + ')'}">(0)</span>
                    </div>
                    <div class="flex items-center space-x-1">
                        <i class="far fa-clock"></i>
                        <span th:text="${(wishlist.vendorService.durationMinutes != null ? wishlist.vendorService.durationMinutes : 0) / 60} + 'h'">0h</span>
                    </div>
                    <div class="flex items-center space-x-1">
                        <i class="far fa-calendar"></i>
                        <span th:text="${(wishlist.vendorService.minNoticeHours != null ? wishlist.vendorService.minNoticeHours : 0)} + 'h trước'">0h trước</span>
                    </div>
                </div>

                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-2xl font-bold text-blue-600"
                             th:text="${#numbers.formatDecimal(wishlist.vendorService.basePrice != null ? wishlist.vendorService.basePrice : 0, 0, 'COMMA', 0, 'POINT')} + 'đ'">0đ</div>
                        <div class="text-xs text-gray-500"
                             th:text="${'/' + #strings.defaultString(wishlist.vendorService.unit, 'dịch vụ')}">/ dịch vụ</div>
                    </div>
                    <div class="flex space-x-2">
                        <a th:href="@{/vendor-services/{id}(id=${wishlist.vendorService.id})}"
                           class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition">Xem</a>
                    </div>
                </div>

                <div class="mt-3 pt-3 border-t text-xs text-gray-500">
                    <i class="far fa-clock mr-1"></i>
                    <span th:text="${'Đã lưu ' + #dates.format(wishlist.createdAt, 'dd/MM/yyyy')}">Đã lưu --/--/----</span>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center py-20" th:if="${#lists.isEmpty(wishlistServices)}">
        <i class="fas fa-heart-broken text-8xl text-gray-300 mb-6"></i>
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Chưa có dịch vụ yêu thích</h2>
        <p class="text-gray-600 mb-8">Khám phá và lưu các dịch vụ bạn quan tâm</p>
        <a class="inline-block px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:shadow-lg transition" href="/services">
            <i class="fas fa-search mr-2"></i>Khám phá dịch vụ
        </a>
    </div>
</div>

<!-- GRID VENDOR -->
<div th:fragment="vendorGrid (favoriteVendors)">
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="vendorsGrid">
        <div class="vendor-card bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden"
             th:each="vendor : ${favoriteVendors}">
            <div class="relative h-32 bg-gradient-to-br from-blue-500 to-purple-600">
                <div class="absolute inset-0 bg-black/20"></div>
                <button class="absolute top-3 right-3 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white transition-all hover:scale-110 z-10"
                        th:onclick="'WL.removeVendor(this,' + ${vendor['userId']} + ')'">
                    <i class="fas fa-heart text-red-500"></i>
                </button>
                <div class="absolute top-3 left-3" th:if="${vendor['verified']}">
          <span class="bg-blue-600 text-white text-xs px-3 py-1 rounded-full font-medium flex items-center space-x-1">
            <i class="fas fa-certificate"></i><span>Đã xác minh</span>
          </span>
                </div>
            </div>

            <div class="relative px-6 -mt-12">
                <div class="w-24 h-24 rounded-full border-4 border-white bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-3xl font-bold shadow-lg">
                    <span th:text="${#strings.substring(vendor['displayName'], 0, 1)}">V</span>
                </div>
            </div>

            <div class="p-6 pt-4">
                <h3 class="text-xl font-bold text-gray-900 mb-2" th:text="${vendor['displayName']}">Vendor</h3>
                <p class="text-sm text-gray-600 mb-4 line-clamp-2" th:text="${vendor['bio'] ?: 'Nhà cung cấp dịch vụ chuyên nghiệp'}">Mô tả</p>

                <div class="grid grid-cols-3 gap-4 mb-4 pb-4 border-b">
                    <div class="text-center">
                        <div class="flex items-center justify-center space-x-1 mb-1">
                            <i class="fas fa-star text-yellow-400 text-sm"></i>
                            <span class="font-bold text-gray-900" th:text="${vendor['ratingAvg'] ?: 0}">0</span>
                        </div>
                        <div class="text-xs text-gray-500">Đánh giá</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-bold text-gray-900" th:text="${vendor['ratingCount'] ?: 0}">0</div>
                        <div class="text-xs text-gray-500">Reviews</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-bold text-gray-900" th:text="${vendor['yearsExperience'] ?: 0}">0</div>
                        <div class="text-xs text-gray-500">Năm KN</div>
                    </div>
                </div>

                <div class="flex items-start space-x-2 text-sm text-gray-600 mb-4">
                    <i class="fas fa-map-marker-alt mt-1 text-gray-400"></i>
                    <span class="line-clamp-1" th:text="${vendor['addressLine'] ?: 'Đang cập nhật'}">Đang cập nhật</span>
                </div>

                <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
          <span><i class="fas fa-concierge-bell mr-1"></i>
            <span th:text="${vendor['servicesCount'] ?: 0}">0</span> dịch vụ
          </span>
                </div>

                <div class="flex space-x-2">
                    <a class="flex-1 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-center rounded-lg font-medium transition"
                       th:href="@{/vendors/{key}(key=${vendor['displayName']})}">Xem chi tiết</a>
                    <a class="flex-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-center rounded-lg font-medium hover:shadow-lg transition"
                       th:href="@{/services/vendors?vendorId={id}(id=${vendor['userId']})}">Dịch vụ</a>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center py-20" th:if="${#lists.isEmpty(favoriteVendors)}">
        <i class="fas fa-store-slash text-8xl text-gray-300 mb-6"></i>
        <h2 class="text-2xl font-bold text-gray-900 mb-4">Chưa có nhà cung cấp yêu thích</h2>
        <p class="text-gray-600 mb-8">Khám phá và lưu các nhà cung cấp uy tín</p>
        <a class="inline-block px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:shadow-lg transition"
           href="/vendors"><i class="fas fa-search mr-2"></i>Tìm nhà cung cấp</a>
    </div>
</div>
</body>
</html>
